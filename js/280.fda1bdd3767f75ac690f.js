"use strict";(self.webpackChunksubscription_inventory=self.webpackChunksubscription_inventory||[]).push([[280],{9116:(e,n,t)=>{t.d(n,{Z:()=>H});var r=t(2950),i=t.n(r),o=t(334),a=t(3476),c=t(5586),s=t(8767),l=t(167),u=t(6808),f=t.n(u);const d={rhsmAPIBase:"https://api.access.qa.redhat.com"};var m=function(){return(m=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)};const v={ci:m({},d),qa:m({},d),stage:m(m({},d),{rhsmAPIBase:"https://api.access.stage.redhat.com"}),prod:m(m({},d),{rhsmAPIBase:"https://api.access.redhat.com"})};var h=function(){try{return window.insights.chrome.auth.getUser()}catch(e){throw new Error("Error authenticating user: "+e.message)}},p=function(){try{return window.insights.chrome.getUserPermissions("subscriptions")}catch(e){throw new Error("Error getting user permissions: "+e.message)}};const g=function(e){var n,t,a=e.children,u=(0,s.useQueryClient)(),d=(0,o.useLocation)(),m=(0,s.useQuery)("user",(function(){return Promise.all([h(),(r=f().get("cs_jwt"),i=(t=(null===(n=null===(e=null===window||void 0===window?void 0:window.insights)||void 0===e?void 0:e.chrome)||void 0===n?void 0:n.getEnvironment())||"ci",v[t]).rhsmAPIBase,fetch(i+"/management/v1/organization",{headers:{Authorization:"Bearer "+r},mode:"cors"}).then((function(e){return e.json()}))),p()]).then((function(e){var n=e[0],t=e[1],r=e[2].map((function(e){return e.permission}));return{accountNumber:n.identity.account_number,canReadProducts:r.includes("subscriptions:products:read")||r.includes("subscriptions:*:*"),isOrgAdmin:!0===n.identity.user.is_org_admin,isSCACapable:!0===t.body.simpleContentAccessCapable}}));var e,n,t,r,i})),g=m.isLoading,y=m.isFetching,E=m.isSuccess,w=m.isError;return(0,r.useEffect)((function(){u.invalidateQueries("user")}),[d.pathname]),E&&(null===(t=null===(n=window.insights)||void 0===n?void 0:n.chrome)||void 0===t||t.hideGlobalFilter()),!0===w?i().createElement(l.Z,null):!0===g||!0===y?i().createElement(c.qb,null):!0===E?i().createElement(i().Fragment,null,a):void 0};var y=(0,r.lazy)((function(){return Promise.all([t.e(252),t.e(736),t.e(994)]).then(t.bind(t,3994))})),E=(0,r.lazy)((function(){return Promise.all([t.e(252),t.e(736),t.e(810)]).then(t.bind(t,2810))})),w=(0,r.lazy)((function(){return Promise.all([t.e(410),t.e(252),t.e(736),t.e(915)]).then(t.bind(t,3915))})),b=function(){return i().createElement("div",{className:"inventory"},i().createElement(r.Suspense,{fallback:i().createElement(c.qb,null)},i().createElement(g,null,i().createElement(o.Switch,null,i().createElement(o.Route,{exact:!0,path:"/",component:y}),i().createElement(o.Route,{path:"/oops",component:E}),i().createElement(o.Route,{path:"/no-permissions",component:w}),i().createElement(o.Route,null,i().createElement(o.Redirect,{to:"/oops"}))))))},k=t(8061),A=t(9421),L=t(4586),P=function(){return(P=Object.assign||function(e){for(var n,t=1,r=arguments.length;t<r;t++)for(var i in n=arguments[t])Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i]);return e}).apply(this,arguments)},N=function(e,n){for(var t=0,r=n.length,i=e.length;t<r;t++,i++)e[i]=n[t];return e},O=i().createContext({notifications:[],addNotification:function(e,n,t){return null},removeNotification:function(e){return null}}),C=function(e){var n=e.children,t=(0,r.useState)([]),o=t[0],a=t[1],c={notifications:o,addNotification:function(e,n,t){return function(e,n,t){var r=function(e,n,t){var r,o={variant:e,message:n,key:(0,L.Z)(),timeout:null===(r=null==t?void 0:t.hasTimeout)||void 0===r||r};if((null==t?void 0:t.alertLinkText)&&(null==t?void 0:t.alertLinkHref)){var a=(null==t?void 0:t.alertLinkIsDownload)?{download:""}:{},c=i().createElement(i().Fragment,null,i().createElement(A.AlertActionLink,null,i().createElement("a",P({href:t.alertLinkHref},a),t.alertLinkText)));o.actionLinks=c}return(null==t?void 0:t.alertLinkIsDownload)&&(null==t?void 0:t.alertLinkHref)&&(o.downloadHref=t.alertLinkHref),o}(e,n,t),c=N(N([],o),[P({},r)]);return(null==t?void 0:t.keyOfAlertToReplace)&&(c=c.filter((function(e){return e.key!==t.keyOfAlertToReplace}))),a(c),r.key}(e,n,t)},removeNotification:function(e){return function(e){a(o.filter((function(n){return n.key!==e})))}(e)}};return i().createElement(O.Provider,{value:c},n)};const R=function(){var e=function(){var e=(0,r.useContext)(O),n=e.notifications,t=e.addNotification;return{notifications:n,addSuccessNotification:function(e,n){return t("success",e,n)},addErrorNotification:function(e,n){return t("danger",e,n)},addInfoNotification:function(e,n){return t("info",e,n)},removeNotification:e.removeNotification}}(),n=e.notifications,t=e.removeNotification;return i().createElement(A.AlertGroup,{isToast:!0},n.map((function(e,n){return i().createElement(A.Alert,{isLiveRegion:!0,timeout:e.timeout,title:e.message,variant:e.variant,key:e.key,actionLinks:e.actionLinks,actionClose:i().createElement(A.AlertActionCloseButton,{"data-testid":"notification-close-btn-"+n,title:e.message,variantLabel:e.variant+" alert",onClose:function(){t(e.key),(null==e?void 0:e.downloadHref)&&window.URL.revokeObjectURL(e.downloadHref)}})})})))};var I=new k.S({defaultOptions:{queries:{retry:3,retryDelay:1e4,staleTime:1/0,refetchOnWindowFocus:!1,refetchOnMount:!1}}});const H=(0,o.withRouter)((0,a.connect)()((function(){var e=(0,o.useHistory)();return(0,r.useEffect)((function(){insights.chrome.init(),insights.chrome.identifyApp("subscriptionInventory");var n=insights.chrome.on("APP_NAVIGATION",(function(n){var t=n.domEvent.href.replace(/^\/insights\/subscriptions\/inventory\/?/,"/");e.push(t)}));return function(){n()}}),[]),i().createElement(s.QueryClientProvider,{client:I},i().createElement(C,null,i().createElement(R,null),i().createElement(b,null)))})))},5586:(e,n,t)=>{t.d(n,{qb:()=>a});var r=t(2950),i=t.n(r),o=t(9421);const a=function(){return i().createElement(o.Bullseye,null,i().createElement(o.Spinner,null))}},319:(e,n,t)=>{t.d(n,{S1:()=>a});var r=t(8738),i=t(8573),o=t.n(i);function a(){for(var e=arguments.length,n=new Array(e),t=0;t<e;t++)n[t]=arguments[t];return(0,r.JH)({},[o()].concat(n))}}}]);
//# sourceMappingURL=../sourcemaps/280.38ca0183e71c5a958775.js.map
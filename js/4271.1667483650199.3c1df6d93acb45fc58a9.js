"use strict";(self.webpackChunksubscription_inventory=self.webpackChunksubscription_inventory||[]).push([[4271],{7094:(e,t,n)=>{n.r(t),n.d(t,{default:()=>T});var a=n(8071),r=n(4748),l=n(123),c=n(9173),u=n(2950),i=n.n(u),o=n(334),s=n(228),m=n(8767),b=function(e,t,n,a){return new(n||(n=Promise))((function(r,l){function c(e){try{i(a.next(e))}catch(e){l(e)}}function u(e){try{i(a.throw(e))}catch(e){l(e)}}function i(e){var t;e.done?r(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,u)}i((a=a.apply(e,t||[])).next())}))},d=function(e,t){var n,a,r,l,c={label:0,sent:function(){if(1&r[0])throw r[1];return r[1]},trys:[],ops:[]};return l={next:u(0),throw:u(1),return:u(2)},"function"==typeof Symbol&&(l[Symbol.iterator]=function(){return this}),l;function u(l){return function(u){return function(l){if(n)throw new TypeError("Generator is already executing.");for(;c;)try{if(n=1,a&&(r=2&l[0]?a.return:l[0]?a.throw||((r=a.return)&&r.call(a),0):a.next)&&!(r=r.call(a,l[1])).done)return r;switch(a=0,r&&(l=[2&l[0],r.value]),l[0]){case 0:case 1:r=l;break;case 4:return c.label++,{value:l[1],done:!1};case 5:c.label++,a=l[1],l=[0];continue;case 7:l=c.ops.pop(),c.trys.pop();continue;default:if(!((r=(r=c.trys).length>0&&r[r.length-1])||6!==l[0]&&2!==l[0])){c=0;continue}if(3===l[0]&&(!r||l[1]>r[0]&&l[1]<r[3])){c.label=l[1];break}if(6===l[0]&&c.label<r[1]){c.label=r[1],r=l;break}if(r&&c.label<r[2]){c.label=r[2],c.ops.push(l);break}r[2]&&c.ops.pop(),c.trys.pop();continue}l=t.call(e,c)}catch(e){l=[6,e],a=0}finally{n=r=0}if(5&l[0])throw l[1];return{value:l[0]?l[1]:void 0,done:!0}}([l,u])}}},f=function(e){return b(void 0,void 0,Promise,(function(){var t;return d(this,(function(n){switch(n.label){case 0:return[4,window.insights.chrome.auth.getToken()];case 1:return t=n.sent(),[4,fetch("/api/rhsm/v2/products/".concat(e),{headers:{Authorization:"Bearer ".concat(t)}})];case 2:return[4,n.sent().json()];case 3:return[2,n.sent().body]}}))}))},p=n(5984),E=n(3193),h=n(6486),v=function(e){var t=e.getUTCMonth()+1,n=e.getUTCDate();return"".concat(e.getUTCFullYear(),"-").concat(t<10?"0".concat(t):t,"-").concat(n<10?"0".concat(n):n)},y=function(e){return""==e?-1:(0,h.parseInt)(e)},g=function(e){return""==e?new Date(0):new Date(e)};const w=function(e){var t,n=e.subscriptions,r=n.map((function(e){return{number:y(e.number),contractNumber:y(e.contractNumber),startDate:g(e.startDate),endDate:g(e.endDate),quantity:y(e.quantity)}})),l=i().useState(1),c=l[0],u=l[1],o=i().useState(10),m=o[0],b=o[1],d=i().useState(0),f=d[0],p=d[1],h=i().useState("asc"),w=h[0],S=h[1],T=i().useState(""),N=T[0],D=T[1],I="Subscription number",L="Contract number",C="Subscription quantity",F="Start date",P="End date",k=function(e){return{sortBy:{index:f,direction:w,defaultDirection:"asc"},onSort:function(e,t,n){p(t),S(n)},columnIndex:e}},A=function(e,t){var n=["number","contractNumber","quantity","startDate","endDate"];return e.sort((function(e,a){var r=0,l=e[n[t]],c=a[n[t]];return l<c?r=-1:l>c&&(r=1),"asc"==w?r:-1*r}))}(r,f),x=function(e,t){return t=t.trim(),e.filter((function(e){var n=-1!=e.number?e.number.toString():"Not Available",a=-1!=e.contractNumber?e.contractNumber.toString():"Not Available";return n.includes(t)||a.includes(t)}))}(A,N),q=function(e){var t=(c-1)*m,n=t+m;return e.slice(t,n)}(x);return i().createElement(i().Fragment,null,i().createElement(a.Flex,{direction:{default:"column",md:"row"},justifyContent:{default:"justifyContentSpaceBetween"}},i().createElement(a.FlexItem,null,r.length>0&&i().createElement(a.SearchInput,{placeholder:"Filter by subscription or contract number",value:N,onChange:function(e){return D(e)},onClear:function(){return D("")}})),i().createElement(a.FlexItem,{align:{default:"alignRight"}},(void 0===t&&(t=a.PaginationVariant.top),i().createElement(a.Pagination,{itemCount:n.length,perPage:m,page:c,onSetPage:function(e,t){u(t)},onPerPageSelect:function(e,t){b(t),u(1)},variant:t})))),i().createElement(E.TableComposable,{"aria-label":"subscriptions",variant:"compact"},i().createElement(E.Thead,null,i().createElement(E.Tr,null,i().createElement(E.Th,{sort:k(0),width:25},I),i().createElement(E.Th,{sort:k(1),width:20},L),i().createElement(E.Th,{sort:k(2),width:25},C),i().createElement(E.Th,{sort:k(3),width:15},F),i().createElement(E.Th,{sort:k(4),width:15},P))),i().createElement(E.Tbody,null,q.map((function(e,t){return i().createElement(i().Fragment,{key:t},i().createElement(E.Tr,null,i().createElement(E.Td,{dataLabel:I},-1==e.number?"Not Available":e.number),i().createElement(E.Td,{dataLabel:L},-1==e.contractNumber?"Not Available":e.contractNumber),i().createElement(E.Td,{dataLabel:C},-1==e.quantity?"Not Available":e.quantity),i().createElement(E.Td,{dataLabel:F},e.startDate==new Date(0)?"Not Available":v(e.startDate)),i().createElement(E.Td,{dataLabel:P},e.endDate==new Date(0)?"Not Available":v(e.endDate))))})))),0==q.length&&i().createElement(s.q,{clearFilters:function(){D("")}}))};var S=n(6456);const T=(0,o.withRouter)((function(){var e,t,n,u=(0,o.useParams)().SKU,E=(0,m.useQueryClient)().getQueryData("user"),h=(n=u,(0,m.useQuery)("singleProduct.".concat(n),(function(){return function(e){return b(void 0,void 0,Promise,(function(){return d(this,(function(t){switch(t.label){case 0:return[4,f(e)];case 1:return[2,t.sent()]}}))}))}(n)}))),v=h.isLoading,y=h.error,g=h.data,T=("subscriptionInventory.detailsTable",e=(0,S.useFlagsStatus)().flagsReady,t=(0,S.useFlag)("subscriptionInventory.detailsTable"),!!e&&t),N="Not Available";return E.canReadProducts?i().createElement((function(){var e;return i().createElement(i().Fragment,null,i().createElement(l.Z,null,v&&!y&&i().createElement(s.$,null),!v&&!y&&i().createElement(i().Fragment,null,i().createElement(a.Breadcrumb,null,i().createElement(a.BreadcrumbItem,{render:function(){return i().createElement(o.Link,{to:"/"},"Subscription Inventory")}}),i().createElement(a.BreadcrumbItem,{isActive:!0},g.name," ")),i().createElement(c.Z,{title:g.name}),i().createElement(a.List,{isPlain:!0},i().createElement(a.ListItem,{className:"pf-u-mt-md"},i().createElement("b",null,"SKU: "),g.sku||N),i().createElement(a.ListItem,{className:"pf-u-mt-0"},i().createElement("b",null,"Quantity: "),null!==(e=g.quantity)&&void 0!==e?e:N),i().createElement(a.ListItem,{className:"pf-u-mt-0"},i().createElement("b",null,"Support level: "),g.serviceLevel||N),i().createElement(a.ListItem,{className:"pf-u-mt-0"},i().createElement("b",null,"Support type: "),g.serviceType||N),i().createElement(a.ListItem,{className:"pf-u-mt-0"},i().createElement("b",null,"Capacity: "),g.capacity?i().createElement(i().Fragment,null,g.capacity.name," ",i().createElement(a.Badge,{isRead:!0},g.capacity.quantity)):i().createElement(i().Fragment,null,"Not Available")))),y&&i().createElement(p.Z,null)),T&&i().createElement(r.Z,null,i().createElement(a.PageSection,{variant:"light"},i().createElement(a.Title,{headingLevel:"h2"},"Subscription details"),v&&!y&&i().createElement(s.$,null),!v&&!y&&i().createElement(w,{subscriptions:null==g?void 0:g.subscriptions}),y&&i().createElement(p.Z,null))))}),null):i().createElement(o.Redirect,{to:"/no-permissions"})}))}}]);
//# sourceMappingURL=../sourcemaps/4271.js.map